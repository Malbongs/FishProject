<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NAKDANG.COM - 구매</title>
    <link rel="stylesheet" href="/static/css/shop.css" />
    <link rel="stylesheet" href="/static/css/footer.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx"
      crossorigin="anonymous"
    />
    <style>
      .for1350 {
        display: flex;
        justify-content: space-between;
      }
      .for1350First {
        position: relative;
        width: 600px;
        height: 500px;
        background: linear-gradient(
          to bottom,
          rgb(230, 245, 250),
          rgb(250, 240, 255)
        );
        border-radius: 15px;
        margin-left: 200px;
      }
      .for1350Second {
        position: relative;
        width: 300px;
        height: 130px;
        background: linear-gradient(
          to bottom,
          rgb(230, 245, 250),
          rgb(250, 240, 255)
        );
        border-radius: 15px;
        margin-right: 200px;
      }
      .payButton1350 {
        font-weight: 500;
        cursor: pointer;
        text-align: center;
        width: 100px;
        border-radius: 5px;
        background-color: rgb(255, 255, 255, 0.5);
        position: absolute;
        bottom: 10px;
        left: 100px;
      }
      .for650 {
        width: 100%;
        text-align: center;
        margin-bottom: 40px;
      }
      .for650First {
        position: relative;
        display: inline-block;
        width: 600px;
        height: 500px;
        background: linear-gradient(
          to bottom,
          rgb(230, 245, 250),
          rgb(250, 240, 255)
        );
        border-radius: 15px;
      }
      .for650Second {
        position: relative;
        display: inline-block;
        width: 300px;
        height: 130px;
        background: linear-gradient(
          to bottom,
          rgb(230, 245, 250),
          rgb(250, 240, 255)
        );
        border-radius: 15px;
      }
      .for350 {
        position: relative;
        width: 100%;
        text-align: center;
        margin-bottom: 40px;
      }
      .for350First {
        position: relative;
        display: inline-block;
        width: 350px;
        height: 500px;
        background: linear-gradient(
          to bottom,
          rgb(230, 245, 250),
          rgb(250, 240, 255)
        );
        border-radius: 15px;
      }
      .for350Second {
        position: relative;
        display: inline-block;
        width: 300px;
        height: 130px;
        background: linear-gradient(
          to bottom,
          rgb(230, 245, 250),
          rgb(250, 240, 255)
        );
        border-radius: 15px;
      }
      .total1350 {
        background-color: rgb(255, 255, 255, 0.5);
        font-weight: 600;
        width: 100%;
        position: absolute;
        padding-left: 20px;
        padding-right: 20px;
        top: 10px;
        font-size: 18px;
        display: flex;
        justify-content: space-between;
      }
      .howToPay1350 {
        width: 100%;
        position: absolute;
        padding-left: 21px;
        padding-right: 20px;
        top: 50px;
        font-size: 18px;
        display: flex;
        justify-content: space-between;
      }
      .option {
        width: 120px;
        border-radius: 5px;
        background: rgb(255, 255, 255, 0.3);
        border: none;
      }
      .buyer {
        left: 10px;
        top: 10px;
        position: absolute;
        display: flex;
        justify-content: center;
      }
      .buyer span:nth-child(1) {
        font-size: 20px;
        font-weight: 500;
      }
      .buyBox {
        position: absolute;
        top: 50px;
        left: 25px;
        width: 550px;
        height: 150px;

        background-color: rgb(255, 255, 255, 0.4);
        border-radius: 10px;
      }
      .buyBox350 {
        position: absolute;
        top: 50px;
        left: 25px;
        width: 300px;
        height: 150px;

        background-color: rgb(255, 255, 255, 0.4);
        border-radius: 10px;
      }

      .name {
        margin-left: 10px;
        width: 100px;
        position: absolute;
        top: 70px;
        left: 25px;
        display: flex;
        justify-content: space-between;
      }
      .name span:nth-child(1) {
        font-weight: 600;
        font-size: 16px;
      }
      .name span:nth-child(2) {
        font-weight: 600;
        font-size: 16px;
      }
      .number {
        width: 200px;
        font-weight: 600;
        font-size: 16px;
        left: 35px;
        top: 100px;
        position: absolute;
        display: flex;
        justify-content: space-between;
      }
      .address {
        width: 500px;
        font-weight: 600;
        font-size: 16px;
        top: 130px;
        left: 35px;
        position: absolute;
        display: flex;
        justify-content: space-between;
      }
      .address350 {
        height: 40px;
        width: 270px;
        font-weight: 600;
        font-size: 16px;
        top: 130px;
        left: 35px;
        position: absolute;
        display: flex;
        justify-content: space-between;
      }
      .selBox {
        width: 400px;
        background-color: rgb(255, 255, 255, 0.6);
        border: none;
        border-radius: 5px;
      }
      .selBox350 {
        height: 30px;
        width: 150px;
        background-color: rgb(255, 255, 255, 0.6);
        border: none;
        border-radius: 5px;
      }
      .bought {
        position: absolute;
        top: 210px;
        font-size: 20px;
        font-weight: 500;
        left: 15px;
      }
      .goodsBox {
        text-align: left;
        position: absolute;
        width: 550px;
        background-color: rgb(255, 255, 255, 0.6);
        border: none;
        border-radius: 10px;
        height: 230px;
        top: 250px;
        left: 25px;
        overflow-y: scroll;
      }
      .goodsBox350 {
        text-align: left;
        position: absolute;
        width: 300px;
        background-color: rgb(255, 255, 255, 0.6);
        border: none;
        border-radius: 10px;
        height: 230px;
        top: 250px;
        left: 25px;
        overflow-y: scroll;
      }

      .put {
        margin-top: 10px;
        margin-left: 10px;
        font-weight: 500;
      }
    </style>
  </head>
  <body>
    <%-include("shopNav.ejs")%>
    <div class="place"></div>
    <%-include("footer.ejs")%>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
      crossorigin="anonymous"
    ></script>
    <script src="/static/js/handleBasket.js"></script>
    <script>
      function draw() {
        const information = JSON.parse(window.localStorage.getItem("order"));
        const quant = information.length;
        let totals = 0;
        information.forEach((ele) => {
          console.log(ele);
          totals += parseInt(ele.price) * parseInt(ele.howMany);
        });
        totals = totals * 0.9;
        totals = totals.toLocaleString();
        if (window.innerWidth >= 1350) {
          const box = document.createElement("div");
          box.classList.add("for1350");
          box.classList.add("forSearch");
          const box1 = document.createElement("div");
          box1.classList.add("for1350First");
          const box2 = document.createElement("div");
          box2.classList.add("for1350Second");
          const payButton = document.createElement("div");
          const total = document.createElement("div");
          total.classList.add("total1350");
          const span = document.createElement("span");
          span.innerText = "총 결제 금액";
          const span2 = document.createElement("span");
          span2.innerText = `${totals}원`;
          const howToPay = document.createElement("div");
          howToPay.classList.add("howToPay1350");

          const span3 = document.createElement("span");
          span3.innerText = "결제수단";
          const option = document.createElement("select");
          option.classList.add("option");
          option.innerHTML =
            "<option>카카오 페이</option><option>신용카드</option><option>네이버페이</option><option>계좌이체</option>";
          howToPay.appendChild(span3);
          howToPay.appendChild(option);
          total.appendChild(span);
          total.appendChild(span2);
          box2.appendChild(total);
          box2.appendChild(howToPay);

          const buyer = document.createElement("div");
          const span4 = document.createElement("span");
          const span5 = document.createElement("span");
          span4.innerText = "구매자 정보";
          buyer.classList.add("buyer");
          buyer.appendChild(span4);
          buyer.appendChild(span5);
          box1.appendChild(buyer);
          const buyBox = document.createElement("div");
          buyBox.classList.add("buyBox");
          box1.appendChild(buyBox);
          const name = document.createElement("div");
          name.classList.add("name");
          const span6 = document.createElement("span");
          const span7 = document.createElement("span");
          span6.innerText = "이름 : ";
          span7.innerText = "우석우";
          name.appendChild(span6);
          name.appendChild(span7);
          box1.appendChild(name);
          const number = document.createElement("div");
          number.classList.add("number");
          const span8 = document.createElement("span");
          const span9 = document.createElement("span");
          span8.innerText = "전화번호 : ";
          span9.innerText = "010-2504-5779";
          number.appendChild(span8);
          number.appendChild(span9);
          box1.appendChild(number);

          const address = document.createElement("div");
          address.classList.add("address");
          const span10 = document.createElement("span");
          span10.innerText = "배송 주소 : ";

          const selBox = document.createElement("select");
          selBox.setAttribute("value", "default");
          selBox.setAttribute("name", "default");
          selBox.classList.add("selBox");
          selBox.innerHTML =
            "<option>기본배송지</option><option>직장</option><option>배송지1</option><option>배송지2</option><option>배송지3</option><option>배송지4</option><option>직접입력</option>";
          const itemList = document.createElement("div");
          const span11 = document.createElement("span");
          span11.classList.add("bought");
          span11.innerText = "구매상품 정보";
          box1.appendChild(span11);
          const goodsBox = document.createElement("div");
          goodsBox.classList.add("goodsBox");
          const goods = JSON.parse(window.localStorage.getItem("order"));
          goods.forEach((ele) => {
            const put = document.createElement("div");
            put.classList.add("put");
            put.innerText = `${ele.title} ${ele.howMany}건 ${parseInt(
              ele.price * 0.9
            ).toLocaleString()}원`;
            goodsBox.appendChild(put);
          });
          box1.appendChild(goodsBox);
          address.appendChild(span10);
          address.appendChild(selBox);
          box1.appendChild(address);
          payButton.classList.add("payButton1350");
          payButton.innerText = "결제하기";
          box2.appendChild(payButton);
          box.appendChild(box1);
          box.appendChild(box2);

          document.querySelector(".place").appendChild(box);
        }
        if (window.innerWidth < 1350 && window.innerWidth >= 650) {
          const box3 = document.createElement("div");
          box3.classList.add("for650");
          box3.classList.add("forSearch");
          const box = document.createElement("div");
          box.classList.add("for650");
          box.classList.add("forSearch");
          const box1 = document.createElement("div");
          box1.classList.add("for650First");
          const box2 = document.createElement("div");
          box2.classList.add("for650Second");
          const payButton = document.createElement("div");
          const total = document.createElement("div");
          total.classList.add("total1350");
          const span = document.createElement("span");
          span.innerText = "총 결제 금액";
          const span2 = document.createElement("span");
          span2.innerText = `${totals}원`;
          const howToPay = document.createElement("div");
          howToPay.classList.add("howToPay1350");
          const buyer = document.createElement("div");
          const span4 = document.createElement("span");
          const span5 = document.createElement("span");
          span4.innerText = "구매자 정보";
          buyer.classList.add("buyer");
          buyer.appendChild(span4);
          buyer.appendChild(span5);
          box1.appendChild(buyer);
          const buyBox = document.createElement("div");
          buyBox.classList.add("buyBox");
          box1.appendChild(buyBox);
          const name = document.createElement("div");
          name.classList.add("name");
          const span6 = document.createElement("span");
          const span7 = document.createElement("span");
          span6.innerText = "이름 : ";
          span7.innerText = "우석우";
          name.appendChild(span6);
          name.appendChild(span7);
          box1.appendChild(name);
          const number = document.createElement("div");
          number.classList.add("number");
          const span8 = document.createElement("span");
          const span9 = document.createElement("span");
          span8.innerText = "전화번호 : ";
          span9.innerText = "010-2504-5779";
          number.appendChild(span8);
          number.appendChild(span9);
          box1.appendChild(number);

          const address = document.createElement("div");
          address.classList.add("address");
          const span10 = document.createElement("span");
          span10.innerText = "배송 주소 : ";

          const selBox = document.createElement("select");
          selBox.setAttribute("value", "default");
          selBox.setAttribute("name", "default");
          selBox.classList.add("selBox");
          selBox.innerHTML =
            "<option>기본배송지</option><option>직장</option><option>배송지1</option><option>배송지2</option><option>배송지3</option><option>배송지4</option><option>직접입력</option>";
          const itemList = document.createElement("div");
          const span11 = document.createElement("span");
          span11.classList.add("bought");
          span11.innerText = "구매상품 정보";
          box1.appendChild(span11);
          const goodsBox = document.createElement("div");
          goodsBox.classList.add("goodsBox");
          const goods = JSON.parse(window.localStorage.getItem("order"));
          goods.forEach((ele) => {
            const put = document.createElement("div");
            put.classList.add("put");
            put.innerText = `${ele.title} ${ele.howMany}건 ${parseInt(
              ele.price * 0.9
            ).toLocaleString()}원`;
            goodsBox.appendChild(put);
          });
          box1.appendChild(goodsBox);
          address.appendChild(span10);
          address.appendChild(selBox);
          box1.appendChild(address);
          const span3 = document.createElement("span");
          span3.innerText = "결제수단";
          const option = document.createElement("select");
          option.classList.add("option");
          option.innerHTML =
            "<option>카카오 페이</option><option>신용카드</option><option>네이버페이</option><option>계좌이체</option>";
          howToPay.appendChild(span3);
          howToPay.appendChild(option);
          total.appendChild(span);
          total.appendChild(span2);
          box2.appendChild(total);
          box2.appendChild(howToPay);
          payButton.classList.add("payButton1350");
          payButton.innerText = "결제하기";
          box2.appendChild(payButton);
          box3.appendChild(box2);
          box.appendChild(box1);

          document.querySelector(".place").appendChild(box);
          document.querySelector(".place").appendChild(box3);
        }
        if (window.innerWidth < 650) {
          const box3 = document.createElement("div");
          box3.classList.add("for350");
          box3.classList.add("forSearch");
          const box = document.createElement("div");
          box.classList.add("for350");
          box.classList.add("forSearch");
          const box1 = document.createElement("div");
          box1.classList.add("for350First");
          const box2 = document.createElement("div");
          box2.classList.add("for350Second");
          const payButton = document.createElement("div");
          const total = document.createElement("div");
          total.classList.add("total1350");
          const span = document.createElement("span");
          span.innerText = "총 결제 금액";
          const span2 = document.createElement("span");
          span2.innerText = `${totals}원`;
          const howToPay = document.createElement("div");
          howToPay.classList.add("howToPay1350");

          const span3 = document.createElement("span");
          span3.innerText = "결제수단";
          const option = document.createElement("select");
          option.classList.add("option");
          option.innerHTML =
            "<option>카카오 페이</option><option>신용카드</option><option>네이버페이</option><option>계좌이체</option>";
          const buyer = document.createElement("div");
          const span4 = document.createElement("span");
          const span5 = document.createElement("span");
          span4.innerText = "구매자 정보";
          buyer.classList.add("buyer");
          buyer.appendChild(span4);
          buyer.appendChild(span5);
          box1.appendChild(buyer);
          const buyBox = document.createElement("div");
          buyBox.classList.add("buyBox350");
          box1.appendChild(buyBox);
          const name = document.createElement("div");
          name.classList.add("name");
          const span6 = document.createElement("span");
          const span7 = document.createElement("span");
          span6.innerText = "이름 : ";
          span7.innerText = "우석우";
          name.appendChild(span6);
          name.appendChild(span7);
          box1.appendChild(name);
          const number = document.createElement("div");
          number.classList.add("number");
          const span8 = document.createElement("span");
          const span9 = document.createElement("span");
          span8.innerText = "전화번호 : ";
          span9.innerText = "010-2504-5779";
          number.appendChild(span8);
          number.appendChild(span9);
          box1.appendChild(number);

          const address = document.createElement("div");
          address.classList.add("address350");
          const span10 = document.createElement("span");
          span10.innerText = "배송 주소 : ";

          const selBox = document.createElement("select");
          selBox.setAttribute("value", "default");
          selBox.setAttribute("name", "default");
          selBox.classList.add("selBox350");
          selBox.innerHTML =
            "<option>기본배송지</option><option>직장</option><option>배송지1</option><option>배송지2</option><option>배송지3</option><option>배송지4</option><option>직접입력</option>";
          const itemList = document.createElement("div");
          const span11 = document.createElement("span");
          span11.classList.add("bought");
          span11.innerText = "구매상품 정보";
          box1.appendChild(span11);
          const goodsBox = document.createElement("div");
          goodsBox.classList.add("goodsBox350");
          const goods = JSON.parse(window.localStorage.getItem("order"));
          goods.forEach((ele) => {
            const put = document.createElement("div");
            put.classList.add("put");
            put.innerText = `${ele.title} ${ele.howMany}건 ${parseInt(
              ele.price * 0.9
            ).toLocaleString()}원`;
            goodsBox.appendChild(put);
          });
          box1.appendChild(goodsBox);
          address.appendChild(span10);
          address.appendChild(selBox);
          box1.appendChild(address);
          howToPay.appendChild(span3);
          howToPay.appendChild(option);
          total.appendChild(span);
          total.appendChild(span2);
          box2.appendChild(total);
          box2.appendChild(howToPay);
          payButton.classList.add("payButton1350");
          payButton.innerText = "결제하기";
          box2.appendChild(payButton);
          box3.appendChild(box2);
          box.appendChild(box1);

          document.querySelector(".place").appendChild(box);
          document.querySelector(".place").appendChild(box3);
        }

        const selBox1 = document.querySelector(".selBox");
        if (selBox1) {
          selBox1
            .querySelector("option:nth-child(7)")
            .setAttribute("value", "dir");
          selBox1.addEventListener("change", (event) => {
            console.log(event.target.getAttribute("value"));
            if (event.target.getAttribute("value") == "dir") {
              if (!document.querySelector(".inputBox")) {
                const temp = document.createElement("input");
                temp.classList.add("inputBox");
                document.querySelector(".for1350First").appendChild(temp);
              }
            } else {
              if (document.querySelector(".inputBox")) {
                document.querySelector(".inputBox").remove();
              }
            }
          });
        }
        document
          .querySelector(".payButton1350")
          .addEventListener("click", (event) => {
            const time = new Date().getTime();
            const ordered = JSON.parse(window.localStorage.getItem("order"));
            ordered.forEach((ele) => {
              ele.ID = time;
            });
            if (!window.localStorage.getItem("ordered")) {
              window.localStorage.setItem("ordered", JSON.stringify([]));
            }
            const list = JSON.parse(window.localStorage.getItem("ordered"));
            list.push(ordered);
            window.localStorage.setItem("ordered", JSON.stringify(list));
            if (information[0].from == "true") {
              window.localStorage.setItem("basket", JSON.stringify([]));
            }

            alert("성공적으로 구매하였습니다");
            window.location = "/shop";
          });
      }
      draw();
      window.addEventListener("resize", (event) => {
        if (window.innerWidth > 1350) {
          if (!document.querySelector(".for1350")) {
            if (document.querySelectorAll(".forSearch")) {
              document.querySelectorAll(".forSearch").forEach((ele) => {
                ele.remove();
              });
            }
            draw();
          }
        }
        if (window.innerWidth <= 1350 && window.innerWidth >= 650) {
          if (!document.querySelector(".for650")) {
            if (document.querySelectorAll(".forSearch")) {
              document.querySelectorAll(".forSearch").forEach((ele) => {
                ele.remove();
              });
            }
            draw();
          }
        }
        if (window.innerWidth <= 650) {
          if (!document.querySelector(".for350")) {
            if (document.querySelectorAll(".forSearch")) {
              document.querySelectorAll(".forSearch").forEach((ele) => {
                ele.remove();
              });
            }
            draw();
          }
        }
      });
    </script>
  </body>
</html>
